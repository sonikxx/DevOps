## Part1. Инструмент ipcalc
### 1.1. Сети и маски
* Адрес сети 192.167.38.54/13 - 192.160.0.0 <br>
<img alt="part1.0" src="./img/1.0.jpg" /> <br>

* Перевод маски 255.255.255.0 в префиксную запись - /24 и двоичную запись - 11111111.11111111.11111111.00000000 <br>
<img alt="part1.1" src="./img/1.1.jpg" /> <br>
Перевод /15 в обычную запись - 255.254.0.0 и двоичную запись - 11111111.11111110.00000000.00000000 <br>
<img alt="part1.2" src="./img/1.2.jpg" /> <br>
Перевод 11111111.11111111.11111111.11110000 в обычную запись - 255.255.255.240 и префиксную запись - /28<br>
<img alt="part1.3" src="./img/1.3.jpg" /> <br>

* Минимальный и максимальный хост в сети 12.167.38.4: <br>
при маске /8 минимальный хост - 12.0.0.1 и максимальный хост - 12.255.255.254 <br>
<img alt="part1.4" src="./img/1.4.jpg" /> <br>
при маске 11111111.11111111.00000000.00000000 минимальный хост - 12.167.0.1 и максимальный хост - 12.167.255.254 <br>
<img alt="part1.5" src="./img/1.5.jpg" /> <br>
при маске 255.255.254.0 минимальный хост - 12.167.38.1 и максимальный хост - 12.167.39.254 <br>
<img alt="part1.6" src="./img/1.6.jpg" /> <br>
при маске /4 минимальный хост - 0.0.0.1 и максимальный хост - 15.255.255.254 <br>
<img alt="part1.7" src="./img/1.7.jpg" /> <br>

### 1.2. localhost
* Определить, можно ли обратиться к приложению, работающему на localhost, с IP: 194.34.23.100, 127.0.0.2, 127.1.0.1, 128.0.0.1. Диапазон IP-адресов, которые предназначены для создания локальных сетей 127.0.0.1 - 127.255.255.255. поэтому к 194.34.23.100 и 128.0.0.1 обратиться нельзя, а к 127.0.0.2 и 127.1.0.1 - можно<br>

### 1.3. Диапазоны и сегменты сетей
* Какие из перечисленных IP можно использовать в качестве публичного, а какие только в качестве частных: 10.0.0.45, 134.43.0.2, 192.168.4.2, 172.20.250.4, 172.0.2.1, 192.172.0.1, 172.68.0.2, 172.16.255.255, 10.10.10.10, 192.169.168.1 <br>
К частным IP адресам относятся частные сети 10.0.0.0 с маской подсети 255.0.0.0<br>
<img alt="part1.8" src="./img/1.8.jpg" /> <br>
К частным IP адресам относятся частные сети 172.16.0.0-172.31.0.0 с маской подсети 255.240.0.0<br>
<img alt="part1.9" src="./img/1.9.jpg" /> <br>
К частным IP адресам относятся частные сети 192.168.0.0 с маской подсети 255.255.0.0<br>
<img alt="part1.10" src="./img/1.10.jpg" /> <br>
Поэтому из списка IP адресов в качестве публичного можно использовать: 134.43.0.2, 172.0.2.1, 192.172.0.1, 172.68.0.2, 192.169.168.1; а в качестве частного: 10.0.0.45, 192.168.4.2, 172.20.250.4, 172.16.255.255, 10.10.10.10. Также этот результат можно проверить при помощи ipcalc, публичным IP адресам будет присвоен класс сети, а вот для частных IP адресов еще появится надпись "Private Internet"<br>

* Какие из перечисленных IP адресов шлюза возможны у сети 10.10.0.0/18: 10.0.0.1, 10.10.0.2, 10.10.10.10, 10.10.100.1, 10.10.1.255 <br>
<img alt="part1.11" src="./img/1.11.jpg" /> <br>
Так как при установвке IP адреса для сетевого шлюза может быть использован любой доступный адрес из пула адресов хостов, доступных в данной сети (обычно это первый доступный), то следующие IP адреса шлюза возможны для этой сети: 10.10.0.2, 10.10.10.10, 10.10.1.255. <br>

## Part 2. Статическая маршрутизация между двумя машинами
* Поднять две виртуальные машины ws1 и ws2. С помощью команды ip a посмотреть существующие сетевые интерфейсы. Для того, чтобы различать виртуальные машины, поставим hostname в соответствии с названием машины <br>
Сетевой интерфейс ws1 <br>
<img alt="part2.0" src="./img/2.0.jpg" /> <br>
Сетевой интерфейс ws2 <br>
<img alt="part2.1" src="./img/2.1.jpg" /> <br>
Описать сетевой интерфейс, соответствующий внутренней сети, на обеих машинах: lo (loopback device) присутсвует по умолчанию в любой Linux системе, необходим для соединения по сети с этим же устройством и  enp0s3 - сетевой интерфейс доступа к NAT VirtualBox и далее к интернету. Для ws1: lo - 127.0.0.1/8, enp0s3 - 10.0.2.15/24 и для ws2: lo - 127.0.0.1/8, enp0s3 - 10.0.2.15/24<br>

* Задать следующие адреса и маски: ws1 - 192.168.100.10, маска /16, ws2 - 172.24.116.8, маска /12. Выполнить команду netplan apply для перезапуска сервиса сети<br>
После изменения файл etc/netplan/00-installer-config.yaml для ws1 будет выглядеть так: <br>
<img alt="part2.2" src="./img/2.2.jpg" /> <br>
После изменения файл etc/netplan/00-installer-config.yaml для ws2 будет выглядеть так: <br>
<img alt="part2.3" src="./img/2.3.jpg" /> <br>

### 2.1. Добавление статического маршрута вручную
* Добавить статический маршрут от одной машины до другой и обратно при помощи команды вида ip r add <br>
Добавим для машины ws1 маршрут 172.24.116.8<br>
<img alt="part2.4" src="./img/2.4.jpg" /> <br>
А для машины ws2 маршрут 192.168.100.10<br>
<img alt="part2.5" src="./img/2.5.jpg" /> <br>
Пропингуем соединение с 172.24.116.8 из машины ws1. Для того, чтобы успешно пропинговать соединение необходимо было в настройках сети машины изменить тип подключения на "внутренняя сеть"<br>
<img alt="part2.6" src="./img/2.6.jpg" /> <br>
Пропингуем соединение с 192.168.100.10 из машины ws2<br>
<img alt="part2.7" src="./img/2.7.jpg" /> <br>

### 2.2. Добавление статического маршрута с сохранением
* Перезапустить машины, используя команду sudo reboot. Добавить статический маршрут от одной машины до другой с помощью файла etc/netplan/00-installer-config.yaml <br>
После изменения файл etc/netplan/00-installer-config.yaml для ws1 будет выглядеть так: <br>
<img alt="part2.8" src="./img/2.8.jpg" /> <br>
После изменения файл etc/netplan/00-installer-config.yaml для ws2 будет выглядеть так: <br>
<img alt="part2.9" src="./img/2.9.jpg" /> <br>
Пропингуем соединение с 172.24.116.8 из машины ws1, с помощью флага -c можем указать количество пакетов, которые нужно отправить<br>
<img alt="part2.10" src="./img/2.10.jpg" /> <br>
Пропингуем соединение с 192.168.100.10 из машины ws2<br>
<img alt="part2.11" src="./img/2.11.jpg" /> <br>

## Part 3. Утилита iperf3
### 3.1. Скорость соединения
* Перевести и записать в отчёт: 8 Mbps в MB/s, 100 MB/s в Kbps, 1 Gbps в Mbps. 1 байт/с = 8 бит/с <br>
8 Mbps (Мбит/c) =  1 MB/s (Мбайт/c) <br>
100 MB/s (Мбайт/c) = 8 * 100 * 1000 Kbps = 800000 Kbps (Кбит/c) <br>
1 Gbps (Гбит/c) = 1000 Mbps (Мбит/c) <br>

### 3.2. Утилита iperf3
* Измерить скорость соединения между ws1 и ws2. Чтобы проверить пропускную способность сети, необходимо сначала подключиться к удаленному компьютеру, который будем использовать в качестве сервера ws1, и запустить iperf3 в режиме сервера, используя флаг -s, по умолчанию он будет прослушивать порт 5201. С помощью флага -f можно указать единицы измерения.<br>
<img alt="part3.0" src="./img/3.0.jpg" /> <br>
* Затем на вашем локальном компьютере, который мы будем рассматривать как клиент (где происходит фактическое тестирование производительности) ws2,
запустим iperf3 в режиме клиента, используя флаг -c, и укажем хост, на котором работает сервер, в нашем случае это 172.24.116.8. <br>
<img alt="part3.1" src="./img/3.1.jpg" /> <br>

## Part 4. Сетевой экран
### 4.1. Утилита iptables
* Создать файл /etc/firewall.sh, имитирующий фаерволл, на ws1 и ws2. Необходимо добавить в файл подряд следующие правила: <br>
1) на ws1 применить стратегию когда в начале пишется запрещающее правило, а в конце пишется разрешающее правило (это касается пунктов 4 и 5) <br>
2) на ws2 применить стратегию когда в начале пишется разрешающее правило, а в конце пишется запрещающее правило (это касается пунктов 4 и 5) <br>
3) открыть на машинах доступ для порта 22 (ssh) и порта 80 (http) <br>
4) запретить echo reply (машина не должна "пинговаться”, т.е. должна быть блокировка на OUTPUT) <br>
5) разрешить echo reply (машина должна "пинговаться") <br>
Так выглядит файл /etc/firewall.sh для ws1: <br>
<img alt="part4.0" src="./img/4.0.jpg" /> <br>
Так выглядит файл /etc/firewall.sh для ws2: <br>
<img alt="part4.1" src="./img/4.1.jpg" /> <br>

* Запустим файлы на обеих машинах командами chmod +x /etc/firewall.sh и /etc/firewall.sh<br>
Запустим файл на ws1 и при помощи флага -L  выведем список всех действующих правил: <br>
<img alt="part4.2" src="./img/4.2.jpg" /> <br>
Запустим файл на ws2: <br>
<img alt="part4.3" src="./img/4.3.jpg" /> <br>

* Разницу между стратегиями, применёнными в первом и втором файлах заключается в том, что любой поступивший пакет на сервер с iptables проходит по цепочкам, содержащим правила и последовательно выполняет. В первом файле сначала идет запрещающее правило, а во втором - разрешающее, поэтому из ws1 мы сможем пропинговать ws2, а вот из ws2 пропинговать ws1 - нет.<br>

### 4.2. Утилита nmap
* Командой ping найти машину, которая не "пингуется", после чего утилитой nmap показать, что хост машины запущен, в выводе nmap должно быть сказано: Host is up <br>
Из ws1 пингуется адрес ws2 172.24.116.8 <br>
<img alt="part4.4" src="./img/4.4.jpg" /> <br>
Из ws2 НЕ пингуется адрес ws1 192.168.100.10<br>
<img alt="part4.5" src="./img/4.5.jpg" /> <br>
Хость машины ws1 запущен <br>
<img alt="part4.6" src="./img/4.6.jpg" /> <br>

* Сохраним дампы образов в Virtual Box<br>

## Part 5. Статическая маршрутизация сети

### 5.1. Настройка адресов машин
* Настроить конфигурации машин в etc/netplan/00-installer-config.yaml согласно сети на рисунке. В отчёт поместить скрины с содержанием файла etc/netplan/00-installer-config.yaml для каждой машины <br>
Сеть должна иметь данный вид: <br>
<img alt="part5.-1" src="./img/5.-1.jpg" /> <br>
Файл etc/netplan/00-installer-config.yaml для машины ws11: <br>
<img alt="part5.0" src="./img/5.0.jpg" /> <br>
Файл etc/netplan/00-installer-config.yaml для машины ws21: <br>
<img alt="part5.1" src="./img/5.1.jpg" /> <br>
Файл etc/netplan/00-installer-config.yaml для машины ws22: <br>
<img alt="part5.2" src="./img/5.2.jpg" /> <br>
Файл etc/netplan/00-installer-config.yaml для машины r1: <br>
<img alt="part5.3" src="./img/5.3.jpg" /> <br>
Файл etc/netplan/00-installer-config.yaml для машины r2: <br>
<img alt="part5.4" src="./img/5.4.jpg" /> <br>

* Перезапустить сервис сети c помощью команды netplan apply. Если ошибок нет, то командой ip -4 a проверить, что адрес машины задан верно <br>
Вывод команды ip -4 a для машины ws11: <br>
<img alt="part5.5" src="./img/5.5.jpg" /> <br>
Вывод команды ip -4 a для машины ws21: <br>
<img alt="part5.6" src="./img/5.6.jpg" /> <br>
Вывод команды ip -4 a для машины ws22: <br>
<img alt="part5.7" src="./img/5.7.jpg" /> <br>
Вывод команды ip -4 a для машины r1: <br>
<img alt="part5.8" src="./img/5.8.jpg" /> <br>
Вывод команды ip -4 a для машины r2: <br>
<img alt="part5.9" src="./img/5.9.jpg" /> <br>

* Пропингуем ws22 с ws21: <br>
<img alt="part5.10" src="./img/5.10.jpg" /> <br>
Аналогично пропингуем r1 с ws11: <br>
<img alt="part5.11" src="./img/5.11.jpg" /> <br>

### 5.2. Включение переадресации IP-адресов
* Для включения переадресации IP, выполните команду на роутерах: sysctl -w net.ipv4.ip_forward=1. При таком подходе переадресация не будет работать после перезагрузки системы <br>
Вызов и вывод использованной команды для машины r1: <br>
<img alt="part5.12" src="./img/5.12.jpg" /> <br>
Вызов и вывод использованной команды для машины r2: <br>
<img alt="part5.13" src="./img/5.13.jpg" /> <br>

* Откройте файл /etc/sysctl.conf и добавьте в него следующую строку: net.ipv4.ip_forward = 1. При использовании этого подхода, IP-переадресация включена на постоянной основе <br>
Содержание изменённого файла /etc/sysctl.conf для машины r1: <br>
<img alt="part5.14" src="./img/5.14.jpg" /> <br>
Содержание изменённого файла /etc/sysctl.conf для машины r2: <br>
<img alt="part5.15" src="./img/5.15.jpg" /> <br>

### 5.3. Установка маршрута по-умолчанию
* Настроить маршрут по-умолчанию (шлюз) для рабочих станций. Для этого добавить default перед IP роутера в файле конфигураций. В отчёт поместить скрин с содержанием файла etc/netplan/00-installer-config.yaml <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины ws11: <br>
<img alt="part5.16" src="./img/5.16.jpg" /> <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины ws21: <br>
<img alt="part5.17" src="./img/5.17.jpg" /> <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины ws22: <br>
<img alt="part5.18" src="./img/5.18.jpg" /> <br>

* Вызвать ip r и показать, что добавился маршрут в таблицу маршрутизации <br>
Вызов и вывод использованной команды для машины ws11: <br>
<img alt="part5.19" src="./img/5.19.jpg" /> <br>
Вызов и вывод использованной команды для машины ws12: <br>
<img alt="part5.20" src="./img/5.20.jpg" /> <br>
Вызов и вывод использованной команды для машины ws22: <br>
<img alt="part5.21" src="./img/5.21.jpg" /> <br>

* Пропинговать с ws11 роутер r2: <br>
<img alt="part5.22" src="./img/5.22.jpg" /> <br>
И покажем на r2, что пинг доходит. Для этого используем команду: tcpdump -tn -i enp0s8: <br>
<img alt="part5.23" src="./img/5.23.jpg" /> <br>

### 5.4. Добавление статических маршрутов
* Добавить в роутеры r1 и r2 статические маршруты в файле конфигураций <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины r1: <br>
<img alt="part5.24" src="./img/5.24.jpg" /> <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины r2: <br>
<img alt="part5.25" src="./img/5.25.jpg" /> <br>

* Вызвать ip r и показать таблицы с маршрутами на обоих роутерах <br>
Вызов и вывод использованной команды для машины r1: <br>
<img alt="part5.26" src="./img/5.26.jpg" /> <br>
Вызов и вывод использованной команды для машины r2: <br>
<img alt="part5.27" src="./img/5.27.jpg" /> <br>

* Запустить команды на ws11: ip r list 10.10.0.0/[маска сети] и ip r list 0.0.0.0/0 <br>
<img alt="part5.28" src="./img/5.28.jpg" /> <br>
Для адреса 10.10.0.0/18 был выбран маршрут, отличный от 0.0.0.0/0, хотя он попадает под маршрут по-умолчанию. Это происходит потому что маршрут по умолчанию не будет выбран, если есть альтернативый маршрут с более длинной маской. Маршрут по умолчанию имеет более низкий приоритет и срабатывает, когда не найден подходящий маршрут в таблице маршрутизации. <br>

### 5.5. Построение списка маршрутизаторов
* Запустить на r1 команду дампа: tcpdump -tnv -i enp0s8: <br>
<img alt="part5.33" src="./img/5.33.jpg" /> <br>
Вывод команды: <br>
<img alt="part5.29" src="./img/5.29.jpg" /> <br>

* При помощи утилиты traceroute построить список маршрутизаторов на пути от ws11 до ws21: <br>
<img alt="part5.30" src="./img/5.30.jpg" /> <br>

* Утилита Traceroute передаёт первому транзитному узлу IP-пакет. В заголовке такого IP-пакета есть поле TTL (Time To Live) — время жизни пакета. Оно определяет количество хопов, через которые пакет может пройти. На каждом узле TTL уменьшается на единицу. Если на пути к удаленному адресату время жизни пакета станет равно 0, маршрутизатор отбросит пакет и отправит источнику ICMP-сообщение об ошибке «Time Exceeded» (время истекло). Утилита Traceroute вместо ICMP-запроса отправляет 3 UDP-пакета на определенный порт целевого хоста и ожидает ответа о недоступности этого порта. Первый пакет отправляется с TTL=1, второй с TTL=2 и так далее, пока запрос не попадет адресату. Traceroute отправляет UDP-запрос, в каждом запросе есть порт отправителя (Sourсe) и порт получателя (Destination). По умолчанию запрос отправляется на закрытый порт 34434. Когда запрос попадёт на хост назначения, этот хост отправит ответ о недоступности порта «Destination port unreachable» (порт назначения недоступен). Это значит, что адресат получил запрос. Traceroute воспримет этот ответ как завершение трассировки <br>

### 5.6. Использование протокола ICMP при маршрутизации
* Запустить на r1 перехват сетевого трафика, проходящего через eth0 с помощью команды: tcpdump -n -i eth0 icmp <br>
<img alt="part5.31" src="./img/5.31.jpg" /> <br>

* Пропинговать с ws11 несуществующий IP (например, 10.30.0.111) с помощью команды: ping -c 1 10.30.0.111 <br>
<img alt="part5.32" src="./img/5.32.jpg" /> <br>

* Сохранить дампы образов виртуальных машин в Virtual Box <br>

## Part 6. Динамическая настройка IP с помощью DHCP
* Для r2 настроить в файле /etc/dhcp/dhcpd.conf конфигурацию службы DHCP: <br>
1. указать адрес маршрутизатора по-умолчанию, DNS-сервер и адрес внутренней сети <br>
<img alt="part6.0" src="./img/6.0.jpg" /> <br>
2. в файле resolv.conf прописать nameserver 8.8.8.8 <br>
<img alt="part6.1" src="./img/6.1.jpg" /> <br>

* Перезагрузить службу DHCP командой systemctl restart isc-dhcp-server <br>
<img alt="part6.2" src="./img/6.2.jpg" /> <br>
Машину ws21 перезагрузить при помощи reboot и через ip a показать, что она получила адрес (также в файле etc/netplan/00-installer-config.yaml для машины ws21 необходимо изменить dhcp4: true) <br>
<img alt="part6.3" src="./img/6.3.jpg" /> <br>
Также пропинговать ws22 с ws21 <br>
<img alt="part6.4" src="./img/6.4.jpg" /> <br>

* Указать MAC адрес у ws11, для этого в etc/netplan/00-installer-config.yaml надо добавить строки: macaddress: 10:10:10:10:10:BA, dhcp4: true <br>
Содержание изменённого файла etc/netplan/00-installer-config.yaml для машины ws11: <br>
<img alt="part6.5" src="./img/6.5.jpg" /> <br>

* Для r1 настроить аналогично r2, но сделать выдачу адресов с жесткой привязкой к MAC-адресу (ws11). Провести аналогичные тесты <br>
1. Файл /etc/dhcp/dhcpd.conf для машины r1 <br>
<img alt="part6.6" src="./img/6.6.jpg" /> <br>
2. в файле resolv.conf прописать nameserver 8.8.8.8 <br>
<img alt="part6.7" src="./img/6.7.jpg" /> <br>
Перезагрузить службу DHCP командой systemctl restart isc-dhcp-server <br>
<img alt="part6.8" src="./img/6.8.jpg" /> <br>
Машину ws11 перезагрузить при помощи reboot и через ip a показать, что она получила адрес (также необходимо поменять MAC-адрес у 2 адаптера в настройках Virtual Box)<br>
<img alt="part6.9" src="./img/6.9.jpg" /> <br>
Также пропинговать ws22 с ws11 <br>
<img alt="part6.10" src="./img/6.10.jpg" /> <br>

* Запросить с ws21 обновление ip адреса <br>
Вывод команды ip a до обновления: <br>
<img alt="part6.11" src="./img/6.11.jpg" /> <br>
Для обновления сначала освободим текущий сетевой интерфейс sudo dhclient -r enp0s8, а потом получим новый IP-адрес sudo dhclient enp0s8: <br>
<img alt="part6.12" src="./img/6.12.jpg" /> <br>
Вывод команды ip a после обновления: <br>
<img alt="part6.13" src="./img/6.13.jpg" /> <br>

* В данном пункте использовались опции DHCP сервера: routers - шлюз по умолчанию, domain-name-servers - список DNS-серверов <br> 

* Сохранить дампы образов виртуальных машин

### Part 7. NAT
* В файле /etc/apache2/ports.conf на ws22 и r1 изменить строку Listen 80 на Listen 0.0.0.0:80, то есть сделать сервер Apache2 общедоступным <br>
Файл /etc/apache2/ports.conf для машины ws22: <br>
<img alt="part7.0" src="./img/7.0.jpg" /> <br>
Файл /etc/apache2/ports.conf для машины r1: <br>
<img alt="part7.1" src="./img/7.1.jpg" /> <br>

* Запустить веб-сервер Apache командой service apache2 start на ws22 и r1 <br>
Вывод команды для машины ws22: <br>
<img alt="part7.2" src="./img/7.2.jpg" /> <br>
Вывод команды для машины r1: <br>
<img alt="part7.3" src="./img/7.3.jpg" /> <br>

* Добавить в фаервол, созданный по аналогии с фаерволом из Части 4, на r2 следующие правила: <br>
1) удаление правил в таблице filter - iptables -F <br>
2) удаление правил в таблице "NAT" - iptables -F -t nat <br>
3) отбрасывать все маршрутизируемые пакеты - iptables --policy FORWARD DROP <br>
Файл /etc/firewall.sh, имитирующий фаерволл, на машине r2: <br>
<img alt="part7.4" src="./img/7.4.jpg" /> <br>
Запустим файл на командами chmod +x /etc/firewall.sh и /etc/firewall.sh При помощи флага -L выведем список всех действующих правил: <br>
<img alt="part7.5" src="./img/7.5.jpg" /> <br>
Проверить соединение между ws22 и r1 командой ping. При запуске файла с этими правилами, ws22 не должна "пинговаться" с r1 <br>
<img alt="part7.6" src="./img/7.6.jpg" /> <br>

* Добавить в файл ещё одно правило: <br>
4) разрешить маршрутизацию всех пакетов протокола ICMP <br>
Файл /etc/firewall.sh, имитирующий фаерволл, на машине r2: <br>
<img alt="part7.7" src="./img/7.7.jpg" /> <br>
Запустим файл на командами chmod +x /etc/firewall.sh и /etc/firewall.sh При помощи флага -L выведем список всех действующих правил: <br>
<img alt="part7.8" src="./img/7.8.jpg" /> <br>
Проверить соединение между ws22 и r1 командой ping. При запуске файла с этими правилами, ws22 должна "пинговаться" с r1 <br>
<img alt="part7.9" src="./img/7.9.jpg" /> <br>

* Добавить в файл ещё два правила: <br>
5) включить SNAT, а именно маскирование всех локальных ip из локальной сети, находящейся за r2 (по обозначениям из Части 5 - сеть 10.20.0.0)
Совет: стоит подумать о маршрутизации внутренних пакетов, а также внешних пакетов с установленным соединением <br>
6) включить DNAT на 8080 порт машины r2 и добавить к веб-серверу Apache, запущенному на ws22, доступ извне сети <br>
Совет: стоит учесть, что при попытке подключения возникнет новое tcp-соединение, предназначенное ws22 и 80 порту <br>
Файл /etc/firewall.sh, имитирующий фаерволл, на машине r2: <br>
<img alt="part7.10" src="./img/7.10.jpg" /> <br>
Запустим файл на командами chmod +x /etc/firewall.sh и /etc/firewall.sh При помощи флага -L выведем список всех действующих правил: <br>
<img alt="part7.11" src="./img/7.11.jpg" /> <br>
Перед тестированием рекомендуется отключить сетевой интерфейс NAT (его наличие можно проверить командой ip a) в VirtualBox, если он включен <br>

* Проверить соединение по TCP для SNAT, для этого с ws22 подключиться к серверу Apache на r1 командой: telnet [адрес] [порт] <br>
<img alt="part7.12" src="./img/7.12.jpg" /> <br>
Проверить соединение по TCP для DNAT, для этого с r1 подключиться к серверу Apache на ws22 командой telnet (обращаться по адресу r2 и порту 8080) <br>
<img alt="part7.13" src="./img/7.13.jpg" /> <br>

* Сохранить дампы образов виртуальных машин <br>